<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 4: Type Narrowing Techniques - TypeScript Learning Path</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        primary: '#3b82f6',
                        secondary: '#8b5cf6',
                        accent: '#06b6d4',
                    }
                }
            }
        }
    </script>
    <style>
        .code-block { @apply bg-gray-900 text-green-400 p-4 rounded-lg overflow-x-auto font-mono text-sm; }
        .keyword { @apply text-purple-400; }
        .type { @apply text-yellow-400; }
        .string { @apply text-green-400; }
        .comment { @apply text-gray-500; }
        .function { @apply text-blue-400; }
        .progress-bar { @apply h-2 bg-gray-200 rounded-full overflow-hidden; }
        .progress-fill { @apply h-full bg-gradient-to-r from-primary to-accent transition-all duration-500; }
        .lesson-nav { @apply flex items-center justify-between p-4 bg-white rounded-lg shadow-sm border border-gray-200; }
        .nav-btn { @apply px-4 py-2 rounded-lg font-medium transition-colors; }
        .nav-btn:hover { @apply bg-gray-100; }
        .nav-btn:disabled { @apply opacity-50 cursor-not-allowed; }
        .nav-btn.primary { @apply bg-primary text-white hover:bg-blue-600; }
        .quiz-option { @apply p-3 border-2 rounded-lg cursor-pointer transition-all hover:border-primary hover:bg-blue-50; }
        .quiz-option.selected { @apply border-primary bg-blue-50; }
        .quiz-option.correct { @apply border-green-500 bg-green-50; }
        .quiz-option.incorrect { @apply border-red-500 bg-red-50; }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen">
    <div class="fixed top-0 left-0 right-0 bg-white border-b border-gray-200 z-50">
        <div class="max-w-4xl mx-auto px-4 py-3">
            <div class="flex items-center justify-between mb-2">
                <span class="text-sm font-medium text-gray-700">Modul 3: Advanced Types</span>
                <span class="text-sm font-medium text-gray-700" id="progress-text">Lesson 4 of 10</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill" style="width: 40%"></div>
            </div>
        </div>
    </div>

    <main class="max-w-4xl mx-auto px-4 py-8 mt-16">
        <div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
            <div class="flex items-center gap-3 mb-4">
                <span class="bg-primary text-white px-3 py-1 rounded-full text-sm font-medium">Modul 3</span>
                <span class="bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm font-medium">Lesson 4</span>
            </div>
            <h1 class="text-3xl font-bold text-gray-900 mb-4">Type Narrowing Techniques</h1>
            <p class="text-gray-600 leading-relaxed mb-6">
                Type narrowing adalah kemampuan TypeScript untuk menganalisis kode dan menentukan tipe yang lebih spesifik dari sebuah variabel dalam suatu blok. Ada beberapa teknik type narrowing yang bisa kita gunakan, selain type guards yang sudah dibahas.
            </p>
            <div class="flex items-center gap-4 text-sm text-gray-500">
                <span>‚è±Ô∏è 20 menit</span>
                <span>üìä Kesulitan: Menengah</span>
                <span>üìö Tipe: Advanced Types</span>
            </div>
        </div>

        <section class="bg-white rounded-2xl shadow-lg p-8 mb-8">
            <h2 class="text-2xl font-bold text-gray-900 mb-4 flex items-center gap-2">
                <span class="bg-primary text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">1</span>
                Tujuan Pembelajaran
            </h2>
            <ul class="space-y-3 text-gray-700">
                <li class="flex items-start gap-3">
                    <span class="text-green-500 mt-1">‚úì</span>
                    <span>Memahami berbagai teknik type narrowing di TypeScript</span>
                </li>
                <li class="flex items-start gap-3">
                    <span class="text-green-500 mt-1">‚úì</span>
                    <span>Menggunakan <code class="bg-gray-100 px-2 py-1 rounded text-sm font-mono">switch</code> statement untuk narrowing</span>
                </li>
                <li class="flex items-start gap-3">
                    <span class="text-green-500 mt-1">‚úì</span>
                    <span>Narrowing dengan <code class="bg-gray-100 px-2 py-1 rounded text-sm font-mono">truthiness</code> checks (if, === null/undefined)</span>
                </li>
                <li class="flex items-start gap-3">
                    <span class="text-green-500 mt-1">‚úì</span>
                    <span>Menggunakan <code class="bg-gray-100 px-2 py-1 rounded text-sm font-mono">discriminated unions</code> untuk type narrowing otomatis</span>
                </li>
            </ul>
        </section>

        <section class="bg-white rounded-2xl shadow-lg p-8 mb-8">
            <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center gap-2">
                <span class="bg-secondary text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">2</span>
                Penjelasan
            </h2>

            <div class="prose max-w-none text-gray-700 leading-relaxed">
                <p class="mb-4">
                    Type narrowing memungkinkan TypeScript untuk mengurangi (narrow) tipe variabel berdasarkan alur kode. Berbeda dengan type guards yang eksplisit, narrowing sering terjadi otomatis berdasarkan kondisi yang dievaluasi TypeScript.
                </p>

                <h3 class="text-xl font-semibold text-gray-900 mb-3">1. Switch Statements</h3>
                <div class="code-block mb-4">
<pre><code><span class="keyword">type</span> <span class="function">Shape</span> = <span class="string">'circle'</span> | <span class="string">'square'</span> | <span class="string">'triangle'</span>;

<span class="keyword">function</span> <span class="function">describe</span>(shape: Shape) {
    <span class="keyword">switch</span> (shape) {
        <span class="keyword">case</span> <span class="string">'circle'</span>:
            <span class="comment">// shape = 'circle' di sini</span>
            <span class="keyword">return</span> <span class="string">"Lingkaran"</span>;
        <span class="keyword">case</span> <span class="string">'square'</span>:
            <span class="comment">// shape = 'square'</span>
            <span class="keyword">return</span> <span class="string">"Persegi"</span>;
        <span class="keyword">case</span> <span class="string">'triangle'</span>:
            <span class="comment">// shape = 'triangle'</span>
            <span class="keyword">return</span> <span class="string">"Segitiga"</span>;
    }
}</code></pre>
                </div>

                <h3 class="text-xl font-semibold text-gray-900 mb-3">2. Truthiness Narrowing</h3>
                <p class="mb-2">TypeScript memperketat tipe berdasarkan truthiness:</p>
                <div class="code-block mb-4">
<pre><code><span class="keyword">function</span> <span class="function">process</span>(input: <span class="type">string</span> | <span class="keyword">null</span> | <span class="keyword">undefined</span>) {
    <span class="keyword">if</span> (input) {
        <span class="comment">// TypeScript tahu input adalah string (bukan null/undefined)</span>
        console.<span class="function">log</span>(input.<span class="function">toUpperCase</span>());
    } <span class="keyword">else</span> {
        <span class="comment">// Di sini input adalah null atau undefined</span>
        console.<span class="function">log</span>(<span class="string">"No input"</span>);
    }
}</code></pre>
                </div>

                <h3 class="text-xl font-semibold text-gray-900 mb-3">3. Equality Narrowing</h3>
                <p class="mb-2">Menggunakan operator <code class="bg-gray-100 px-2 py-1 rounded text-sm font-mono">===</code>, <code class="bg-gray-100 px-2 py-1 rounded text-sm font-mono">!==</code>, <code class="bg-gray-100 px-2 py-1 rounded text-sm font-mono">==</code>, <code class="bg-gray-100 px-2 py-1 rounded text-sm font-mono">!=</code>:</p>
                <div class="code-block mb-4">
<pre><code><span class="keyword">function</span> <span class="function">handle</span>(x: <span class="type">string</span> | <span class="type">number</span>) {
    <span class="keyword">if</span> (x === <span class="string">"hello"</span>) {
        <span class="comment">// x adalah string</span>
    } <span class="keyword">else</span> <span class="keyword">if</span> (x === <span class="type">100</span>) {
        <span class="comment">// x adalah number dengan nilai 100</span>
    } <span class="keyword">else</span> {
        <span class="comment">// x adalah number (selain 100)</span>
    }
}</code></pre>
                </div>

                <h3 class="text-xl font-semibold text-gray-900 mb-3">4. Discriminated Unions (Tagged Unions)</h3>
                <p class="mb-4">
                    Teknik paling powerful: membuat union dari object types yang memiliki property "discriminator" (tag) yang unik. TypeScript bisa narrow berdasarkan nilai property tersebut.
                </p>
                <div class="code-block mb-4">
<pre><code><span class="keyword">interface</span> <span class="function">Square</span> { kind: <span class="string">'square'</span>; size: <span class="type">number</span>; }
<span class="keyword">interface</span> <span class="function">Rectangle</span> { kind: <span class="string">'rectangle'</span>; width: <span class="type">number</span>; height: <span class="type">number</span>; }
<span class="keyword">interface</span> <span class="function">Circle</span> { kind: <span class="string">'circle'</span>; radius: <span class="type">number</span>; }

<span class="keyword">type</span> <span class="function">Shape</span> = Square | Rectangle | Circle;

<span class="keyword">function</span> <span class="function">area</span>(shape: Shape): <span class="type">number</span> {
    <span class="keyword">switch</span> (shape.kind) {
        <span class="keyword">case</span> <span class="string">'square'</span>:
            <span class="keyword">return</span> shape.size * shape.size;
        <span class="keyword">case</span> <span class="string">'rectangle'</span>:
            <span class="keyword">return</span> shape.width * shape.height;
        <span class="keyword">case</span> <span class="string">'circle'</span>:
            <span class="keyword">return</span> Math.PI * shape.radius * shape.radius;
    }
}</code></pre>
                </div>

                <h3 class="text-xl font-semibold text-gray-900 mb-3">5. Narrowing dengan <code class="bg-gray-100 px-2 py-1 rounded text-sm font-mono">in</code> operator</h3>
                <div class="code-block mb-4">
<pre><code><span class="keyword">function</span> <span class="function">move</span>(pet: { fly(): <span class="keyword">void</span> } | { swim(): <span class="keyword">void</span> }) {
    <span class="keyword">if</span> (<span class="string">"fly"</span> <span class="keyword">in</span> pet) {
        <span class="comment">// TypeScript tahu pet memiliki method fly()</span>
        pet.<span class="function">fly</span>();
    } <span class="keyword">else</span> {
        <span class="comment">// TypeScript tahu pet memiliki method swim()</span>
        pet.<span class="function">swim</span>();
    }
}</code></pre>
                </div>

                <h3 class="text-xl font-semibold text-gray-900 mb-3">6. Type Predicates</h3>
                <p class="mb-4">
                    Seperti yang dibahas di lesson Type Guards, kita bisa membuat fungsi yang mengembalikan <code class="bg-gray-100 px-2 py-1 rounded text-sm font-mono">value is Tipe</code>. TypeScript menggunakan ini untuk narrowing.
                </p>
            </div>
        </section>

        <section class="bg-white rounded-2xl shadow-lg p-8 mb-8">
            <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center gap-2">
                <span class="bg-accent text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">3</span>
                Latihan
            </h2>

            <div class="space-y-6">
                <div class="border border-gray-200 rounded-lg p-6">
                    <h3 class="font-semibold text-gray-900 mb-3">Latihan 1: Discriminated Union untuk API Response</h3>
                    <p class="text-gray-700 mb-4">
                        Buat tipe <code class="bg-gray-100 px-2 py-1 rounded text-sm font-mono">ApiResponse</code> dengan discriminator <code class="bg-gray-100 px-2 py-1 rounded text-sm font-mono">status</code> yang bisa berupa <code class="bg-gray-100 px-2 py-1 rounded text-sm font-mono">'success'</code> atau <code class="bg-gray-100 px-2 py-1 rounded text-sm font-mono">'error'</code>. Buat function <code class="bg-gray-100 px-2 py-1 rounded text-sm font-mono">handleResponse</code> yang menggunakan switch untuk menangani kedua kasus.
                    </p>
                    <details class="cursor-pointer">
                        <summary class="text-primary font-medium hover:text-blue-700">Lihat Solusi</summary>
                        <div class="mt-4 code-block">
<pre><code><span class="keyword">interface</span> <span class="function">SuccessResponse</span> {
    status: <span class="string">'success'</span>;
    data: <span class="keyword">any</span>;
}
<span class="keyword">interface</span> <span class="function">ErrorResponse</span> {
    status: <span class="string">'error'</span>;
    message: <span class="type">string</span>;
}
<span class="keyword">type</span> <span class="function">ApiResponse</span> = SuccessResponse | ErrorResponse;

<span class="keyword">function</span> <span class="function">handleResponse</span>(resp: ApiResponse) {
    <span class="keyword">switch</span> (resp.status) {
        <span class="keyword">case</span> <span class="string">'success'</span>:
            console.<span class="function">log</span>(resp.data);
            <span class="keyword">break</span>;
        <span class="keyword">case</span> <span class="string">'error'</span>:
            console.<span class="function">error</span>(resp.message);
            <span class="keyword">break</span>;
    }
}</code></pre>
                        </div>
                    </details>
                </div>

                <div class="border border-gray-200 rounded-lg p-6">
                    <h3 class="font-semibold text-gray-900 mb-3">Latihan 2: Truthiness dengan Nullable</h3>
                    <p class="text-gray-700 mb-4">
                        Buat function <code class="bg-gray-100 px-2 py-1 rounded text-sm font-mono">greet</code> yang menerima parameter <code class="bg-gray-100 px-2 py-1 rounded text-sm font-mono">name: string | null</code>. Jika name truthy, tampilkan "Hello, [name]!". Jika falsy, tampilkan "Hello, Guest!".
                    </p>
                    <details class="cursor-pointer">
                        <summary class="text-primary font-medium hover:text-blue-700">Lihat Solusi</summary>
                        <div class="mt-4 code-block">
<pre><code><span class="keyword">function</span> <span class="function">greet</span>(name: <span class="type">string</span> | <span class="keyword">null</span>) {
    <span class="keyword">if</span> (name) {
        console.<span class="function">log</span>(<span class="string">`Hello, </span>${name}<span class="string">!`</span>);
    } <span class="keyword">else</span> {
        console.<span class="function">log</span>(<span class="string">"Hello, Guest!"</span>);
    }
}</code></pre>
                        </div>
                    </details>
                </div>
            </div>
        </section>

        <nav class="lesson-nav" aria-label="Lesson navigation">
            <button class="nav-btn primary" onclick="alert('Previous lesson')">
                ‚Üê Sebelumnya
            </button>
            <div class="text-sm text-gray-500">
                Modul 3 - Lesson 4 dari 10
            </div>
            <button class="nav-btn primary" onclick="alert('Next lesson')">
                Selanjutnya ‚Üí
            </button>
        </nav>
    </main>

    <script>
        console.log('Type Narrowing lesson loaded');
    </script>
</body>
</html>